-- =====================================================
-- Задача: Расчет возраста самого молодого курьера
-- Тема: Агрегация данных в SQL
-- Цель: Найти минимальный возраст среди курьеров мужского пола

-- Используемые функции:
-- AGE() - расчет интервала между датами
-- MIN() - агрегатная функция для нахождения минимального значения
-- ::VARCHAR - преобразование типа данных
-- =====================================================

SELECT 
  MIN(
    AGE(birth_date):: VARCHAR
  ) AS min_age 
FROM 
  couriers 
WHERE 
  sex = 'male'

-- Логика решения:
-- 1. WHERE sex = 'male' - фильтрация курьеров мужского пола
-- 2. AGE(birth_date) - вычисление интервала от даты рождения до текущей даты
--    • Если не указана вторая дата, используется CURRENT_DATE
--    • Возвращает интервал в формате 'XX years XX mons XX days'
-- 3. ::VARCHAR - преобразование интервала в текстовый формат
-- 4. MIN() - нахождение минимального значения возраста среди всех курьеров

-- Пример результата:
-- min_age
-- 18 years 2 mons 15 days