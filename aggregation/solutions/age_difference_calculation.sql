-- =====================================================
-- Задача: Расчет разницы в возрасте между пользователями
-- Тема: Агрегация данных в SQL
-- Цель: Найти разницу в возрасте между самой старшей и самой молодой пользовательницей

-- Используемые функции:
-- MIN()/MAX() - агрегатные функции для нахождения крайних дат рождения
-- AGE() - расчет интервала между двумя датами
-- ::VARCHAR - преобразование в читаемый текстовый формат
-- =====================================================

SELECT 
  AGE(
    MAX(birth_date), 
    MIN(birth_date)
  ):: VARCHAR AS age_diff 
FROM 
  users 
WHERE 
  sex = 'female'

-- Логика решения:
-- 1. WHERE sex = 'female' - фильтрация пользователей женского пола
-- 2. MIN(birth_date) - находит самую раннюю дату рождения (самый старший пользователь)
-- 3. MAX(birth_date) - находит самую позднюю дату рождения (самый молодой пользователь)
-- 4. AGE(max_date, min_date) - вычисляет интервал между самой поздней и самой ранней датой
-- 5. ::VARCHAR - преобразует интервал в человеко-читаемый текстовый формат

-- Пример результата:
-- age_diff
-- 45 years 8 mons 15 days
