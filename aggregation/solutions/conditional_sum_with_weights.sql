-- =====================================================
-- Задача: Расчет стоимости заказа с разными количествами товаров
-- Тема: Агрегация данных в SQL
-- Цель: Рассчитать общую стоимость заказа с учетом разных количеств каждого товара

-- Используемые техники:
-- SUM() с вложенным CASE - взвешенная агрегация
-- Условная логика для разных множителей цен
-- =====================================================

SELECT 
    SUM(
        CASE 
            WHEN name = 'сухарики' THEN price * 3
            WHEN name = 'чипсы' THEN price * 2 
            WHEN name = 'энергетический напиток' THEN price 
            ELSE 0 
        END
    ) AS order_price 
FROM products;