-- =====================================================
-- Задача: Анализ крупных заказов по количеству товаров
-- Тема: Агрегация данных в SQL
-- Цель: Найти количество заказов, содержащих 9 и более товаров

-- Используемые функции:
-- COUNT() - агрегатная функция для подсчета
-- ARRAY_LENGTH() - функция возвращает длину указанной размерности массива
-- WHERE с условием на результат функции
-- =====================================================

SELECT 
  COUNT(order_id) AS orders 
FROM 
  orders 
WHERE 
  ARRAY_LENGTH(product_ids, 1) >= 9
