-- =====================================================
-- Задача: Анализ распределения размеров заказов за неделю
-- Тема: Группировка данных в SQL
-- Цель: Проанализировать, какие размеры заказов наиболее популярны за указанную неделю

-- Используемые функции:
-- ARRAY_LENGTH() - подсчет количества товаров в заказе
-- COUNT() - подсчет заказов каждого размера
-- GROUP BY - группировка по размеру заказа
-- BETWEEN - фильтрация по временному периоду
-- =====================================================

SELECT 
  ARRAY_LENGTH(product_ids, 1) AS order_size, 
  COUNT(order_id) AS orders_count 
FROM 
  orders 
WHERE 
  creation_time BETWEEN '2022-08-29' 
  AND '2022-09-04' 
GROUP BY 
  ARRAY_LENGTH(product_ids, 1) 
ORDER BY 
  ARRAY_LENGTH(product_ids, 1)
