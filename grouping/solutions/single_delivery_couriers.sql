-- =====================================================
-- Задача: Анализ курьеров с единичными доставками
-- Тема: Группировка данных в SQL
-- Цель: Выявить курьеров, которые доставили только один заказ за сентябрь 2022

-- Используемые операторы:
-- WHERE с временным фильтром и фильтром по действию
-- GROUP BY с HAVING - группировка с условием на агрегированные данные
-- ORDER BY - сортировка результатов
-- =====================================================

SELECT 
  courier_id 
FROM 
  courier_actions 
WHERE 
  action = 'deliver_order' 
  AND time BETWEEN '2022-09-01' 
  AND '2022-10-01' 
GROUP BY 
  courier_id 
HAVING 
  COUNT(order_id) = 1 
ORDER BY 
  courier_id
