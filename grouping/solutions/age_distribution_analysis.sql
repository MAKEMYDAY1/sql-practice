-- =====================================================
-- Задача: Анализ распределения пользователей по возрастам
-- Тема: Группировка данных в SQL
-- Цель: Создать распределение пользователей по возрастным группам (по годам)

-- Используемые функции:
-- AGE() - расчет интервала между датой рождения и текущей датой
-- DATE_PART() - извлечение количества полных лет
-- COUNT() - подсчет пользователей в каждой возрастной группе
-- GROUP BY - группировка по возрасту
-- ORDER BY - сортировка по возрасту
-- =====================================================

SELECT 
  DATE_PART(
    'year', 
    AGE(birth_date)
  ):: INTEGER AS age, 
  COUNT(user_id) AS users_count 
FROM 
  users 
GROUP BY 
  DATE_PART(
    'year', 
    AGE(birth_date)
  ):: INTEGER 
ORDER BY 
  DATE_PART(
    'year', 
    AGE(birth_date)
  ):: INTEGER
