-- =====================================================
-- Задача: Анализ максимального возраста пользователей по полу
-- Тема: Группировка данных в SQL
-- Цель: Найти максимальный возраст пользователей отдельно для мужчин и женщин

-- Используемые функции:
-- GROUP BY - группировка по полу пользователей
-- AGE() - расчет интервала между датой рождения и текущей датой
-- DATE_PART() - извлечение количества полных лет из интервала
-- MAX() - агрегатная функция для нахождения максимального значения
-- ::INTEGER - преобразование типа данных
-- =====================================================

SELECT 
  sex, 
  MAX(
    DATE_PART(
      'year', 
      AGE(birth_date)
    )
  ):: INTEGER AS max_age 
FROM 
  users 
GROUP BY 
  sex
