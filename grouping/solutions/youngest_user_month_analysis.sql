-- =====================================================
-- Задача: Анализ месяца рождения самого молодого пользователя по полу
-- Тема: Группировка данных в SQL
-- Цель: Найти месяц рождения самого молодого пользователя отдельно для мужчин и женщин

-- Используемые функции:
-- GROUP BY - группировка по полу пользователей
-- MAX() - нахождение самой поздней даты рождения (самого молодого пользователя)
-- DATE_PART() - извлечение месяца из даты
-- ::INTEGER - преобразование типа данных
-- =====================================================

SELECT 
  sex, 
  date_part(
    'month', 
    MAX(birth_date)
  ):: INTEGER AS max_month 
FROM 
  users 
GROUP BY 
  sex
