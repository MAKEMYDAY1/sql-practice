-- =====================================================
-- Задача: Анализ максимального месяца рождения по полу
-- Тема: Группировка данных в SQL
-- Цель: Найти самый поздний месяц рождения среди пользователей отдельно для мужчин и женщин

-- Используемые функции:
-- GROUP BY - группировка по полу пользователей
-- DATE_PART() - извлечение месяца из даты рождения
-- MAX() - агрегатная функция для нахождения максимального значения
-- ::INTEGER - преобразование типа данных
-- =====================================================

SELECT 
  sex, 
  MAX(
    DATE_PART('month', birth_date)
  ):: INTEGER AS max_month 
FROM 
  users 
GROUP BY 
  sex
