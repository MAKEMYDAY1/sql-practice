-- =====================================================
-- Задача: Анализ самых активных пользователей за август 2022
-- Тема: Группировка данных в SQL
-- Цель: Выявить топ-5 пользователей по количеству оформленных заказов за август 2022

-- Используемые операторы:
-- WHERE с временным фильтром и фильтром по действию
-- GROUP BY с COUNT - группировка и подсчет заказов по пользователям
-- LIMIT - ограничение результата топ-5
-- =====================================================

SELECT 
  user_id, 
  COUNT(order_id) AS created_orders 
FROM 
  user_actions 
WHERE 
  time BETWEEN '2022-08-01' 
  AND '2022-09-01' 
  AND action = 'create_order' 
GROUP BY 
  user_id 
ORDER BY 
  COUNT(order_id) DESC, 
  user_id 
LIMIT 
  5
