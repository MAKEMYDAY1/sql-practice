-- =====================================================
-- Задача: Поиск пользователей с последним заказом до указанной даты
-- Тема: Группировка данных в SQL
-- Цель: Найти пользователей, которые не делали заказов после 7 сентября 2022 года включительно

-- Используемые операторы:
-- GROUP BY с HAVING - группировка с условием на агрегированные данные
-- MAX() - нахождение времени последнего заказа
-- WHERE - фильтрация по типу действия
-- =====================================================

SELECT 
  user_id 
FROM 
  user_actions 
WHERE 
  action = 'create_order' 
GROUP BY 
  user_id 
HAVING 
  MAX(time) < '2022-09-08' 
ORDER BY 
  user_id