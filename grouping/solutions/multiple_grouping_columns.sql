-- =====================================================
-- Задача: Многомерный анализ заказов по времени и действиям
-- Тема: Группировка данных в SQL
-- Цель: Проанализировать динамику созданных и отмененных заказов по месяцам

-- Используемые операторы:
-- GROUP BY с несколькими колонками - многомерная группировка
-- DATE_TRUNC() - временная агрегация
-- ORDER BY с несколькими полями - комплексная сортировка
-- =====================================================

SELECT 
  DATE_TRUNC('month', time) AS month, 
  action, 
  COUNT(order_id) AS orders_count 
FROM 
  user_actions 
GROUP BY 
  DATE_TRUNC('month', time), 
  action 
ORDER BY 
  DATE_TRUNC('month', time), 
  action
