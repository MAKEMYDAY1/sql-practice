-- =====================================================
-- Задача: Поиск последних доставок конкретного курьера
-- Тема: Фильтрация данных в SQL
-- Цель: Найти 10 последних заказов, доставленных курьером с ID 100

-- Используемые операторы:
-- WHERE с фильтрацией по ID курьера и типу действия
-- ORDER BY DESC - сортировка по времени для нахождения последних событий
-- LIMIT - ограничение количества результатов

-- =====================================================

SELECT 
  order_id, 
  time 
FROM 
  courier_actions 
WHERE 
  courier_id = 100 
  AND action = 'deliver_order' 
ORDER BY 
  time DESC 
LIMIT 
  10

-- Логика решения:
-- 1. courier_id = 100 - фильтрация действий конкретного курьера
-- 2. action = 'deliver_order' - отбор только успешных доставок (исключает pick_up и другие действия)
-- 3. ORDER BY time DESC - сортировка по убыванию времени (последние доставки первыми)
-- 4. LIMIT 10 - берем только 10 самых последних доставок

-- Пример результата:
-- order_id | time
-- 10457    | 2023-11-15 14:30:15
-- 10456    | 2023-11-15 12:45:22
-- 10455    | 2023-11-15 11:15:08
-- 10452    | 2023-11-14 18:20:45