-- =====================================================
-- Задача: Анализ "осиротевших" заказов - принятых курьерами, но не созданных пользователями
-- Тема: Валидация данных и поиск аномалий с NOT IN

-- Цель: Выявить расхождения в данных между таблицами курьерских и пользовательских действий
-- =====================================================
SELECT 
  COUNT(*) AS orders_count 
FROM 
  courier_actions 
WHERE 
  action = 'accept_order' 
  AND order_id NOT IN (
    SELECT 
      order_id 
    FROM 
      user_actions 
    WHERE 
      action = 'create_order'
  )
