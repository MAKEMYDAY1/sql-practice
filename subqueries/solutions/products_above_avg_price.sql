-- =====================================================
-- Задача: Фильтрация товаров с ценой выше средней на 20+ рублей
-- Тема: Арифметические операции с подзапросами
-- Цель: Выявить премиальные товары, цена которых значительно превышает среднюю по каталогу

-- Используемые операторы:
-- Скалярный подзапрос в WHERE - вычисление средней цены
-- Арифметические операции с результатом подзапроса (+)
-- Оператор сравнения >= для фильтрации по порогу
-- ORDER BY DESC - сортировка по убыванию идентификатора
-- =====================================================

SELECT 
  product_id, 
  name, 
  price 
FROM 
  products 
WHERE 
  price >= (
    SELECT 
      AVG(price) 
    FROM 
      products
  ) + 20 
ORDER BY 
  product_id DESC
