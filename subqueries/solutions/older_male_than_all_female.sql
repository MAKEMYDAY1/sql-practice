-- =====================================================
-- Задача: Поиск пользователей мужского пола, которые старше всех пользователей женского пола
-- Тема: Сравнительный анализ между группами с агрегатными функциями

-- Цель: Выявить мужчин, которые по возрасту превосходят всех женщин в системе
-- =====================================================
SELECT 
  user_id, 
  birth_date 
FROM 
  users 
WHERE 
  sex = 'male' 
  AND birth_date < (
    SELECT 
      MIN(birth_date) 
    FROM 
      users 
    WHERE 
      sex = 'female'
  ) 
ORDER BY 
  user_id
