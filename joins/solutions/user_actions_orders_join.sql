-- =====================================================
-- Задача: Объединение пользовательских действий с деталями заказов
-- Тема: LEFT JOIN для сохранения всех действий пользователей

-- Цель: Создать комплексное представление о действиях пользователей с информацией о составе заказов

-- Используемые операторы:
-- LEFT JOIN - объединение с сохранением всех записей из левой таблицы
-- ORDER BY - сортировка по нескольким колонкам
-- LIMIT - ограничение вывода для больших наборов данных
-- =====================================================
SELECT 
  user_id, 
  user_actions.order_id, 
  product_ids 
FROM 
  user_actions 
  LEFT JOIN orders ON user_actions.order_id = orders.order_id 
ORDER BY 
  user_id, 
  order_id 
LIMIT 
  1000
