-- =====================================================
-- Задача: Объединение данных о действиях пользователей с их демографическими профилями
-- Тема: Базовый INNER JOIN между таблицами

-- Цель: Создать комплексное представление о пользователях, объединив их действия с демографическими данными

-- Используемые операторы:
-- JOIN - объединение таблиц по ключевому полю
-- AS - создание алиасов для колонок
-- ORDER BY - сортировка результатов
-- =====================================================
SELECT 
  user_actions.user_id AS user_id_left, 
  users.user_id AS user_id_right, 
  order_id, 
  time, 
  action, 
  sex, 
  birth_date 
FROM 
  user_actions 
  JOIN users ON user_actions.user_id = users.user_id 
ORDER BY 
  user_actions.user_id

-- Логика решения:
-- 1. JOIN users ON user_actions.user_id = users.user_id - объединение таблиц по ключевому полю
--    • INNER JOIN возвращает только строки, где есть соответствие в обеих таблицах
--    • Условие соединения: совпадение user_id в обеих таблицах
--
-- 2. user_actions.user_id AS user_id_left - ID пользователя из таблицы действий
--    • Показывает, из какой таблицы взято значение
--    • Помогает в отладке при сложных соединениях
--
-- 3. users.user_id AS user_id_right - ID пользователя из таблицы профилей
--    • Должен совпадать с user_id_left при корректном соединении
--    • Демонстрирует правильность работы JOIN
--
-- 4. order_id, time, action - данные о действиях пользователей из user_actions
--    • Информация о заказах и временных метках
--
-- 5. sex, birth_date - демографические данные из users
--    • Позволяют анализировать поведение с учётом пола и возраста
--
-- 6. ORDER BY user_actions.user_id - сортировка по возрастанию ID
--    • Упорядочивает результат для удобства анализа
--    • Можно использовать любую из колонок user_id (они идентичны)

-- Пример результата:
-- user_id_left | user_id_right | order_id | time                | action       | sex  | birth_date
-- 1            | 1             | 1001     | 2022-08-24 10:30:00 | create_order | male | 1990-05-15
-- 1            | 1             | 1001     | 2022-08-24 10:35:00 | cancel_order | male | 1990-05-15
-- 2            | 2             | 1002     | 2022-08-24 11:20:00 | create_order | female| 1985-11-20
