-- =====================================================
-- Задача: Анализ пользовательских действий с включением всех записей из таблицы действий
-- Тема: LEFT JOIN для сохранения всех записей из левой таблицы

-- Цель: Сохранить все действия пользователей, даже если отсутствует демографическая информация

-- Используемые операторы:
-- LEFT JOIN - объединение с сохранением всех записей из левой таблицы
-- AS - создание алиасов для колонок
-- ORDER BY - сортировка результатов
-- =====================================================
SELECT 
  user_actions.user_id AS user_id_left, 
  users.user_id AS user_id_right, 
  order_id, 
  time, 
  action, 
  sex, 
  birth_date 
FROM 
  user_actions 
  LEFT JOIN users ON user_actions.user_id = users.user_id 
ORDER BY 
  user_actions.user_id
